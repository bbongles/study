<html>
<head>
  <meta charset="utf-8">
</head>

<!-- Watch 속성 -->
<body>
	<!-- 
	- 대부분 Computed이 적절하지만, 사용자 지정 감시가 필요한 경우 Watch 옵션을 사용하여 데이터의 변경에 대응.
	- 데이터 변경의 응답으로 비동기 혹은 비용이 많이 드는 작업 수행시 유용.
	-->
	<div id="watch-example">
		<p>
			예/아니오 질문을 물어보세요.
			<input v-model="question" />
		</p>
		<p>
			{{ answer }}
		</p>
	</div>
	
	<!-- Computed 속성 vs Watch 속성 -->
	<div id="demo">{{ fullName }}</div>
	
</body>

<!-- 이미 Ajax 라이브러리의 풍부한 생태계와 범용 유틸리티 메소드 컬렉션이 있기 때문에, -->
<!-- Vue 코어는 다시 만들지 않아 작게 유지됩니다. -->
<!-- 이것은 이미 익숙한 것을 선택할 수 있는 자유를 줍니다. -->
<script src="https://cdn.jsdelivr.net/npm/axios@0.12.0/dist/axios.min.js"></script>
<script src="https://unpkg.com/vue@next"></script>
<script type="text/javascript">
	/* 
	- 아래의 예제는 watch 옵션을 사요하여 비동기 작업(API 접근)을 수행하고, 이 작업을 수행하기 위한 조건을 설정한 예
	- 추가적으로 watch 옵션 외에도 명령형 vm.$watch API를 사용하는 방법도 있음
	*/
	const watchExampleVM = Vue.createApp({
		data() {
			return {
				question: '',
				answer: '질문은 보통 물음표를 포함합니다. ;-)'
			}
		},
		watch: {
			// question이 변경될 때마다, 이 함수가 실행
			question(newQuestion, oldQuestion) {
				if (newQuestion.indexOf('?') > -1) {
					this.getAnswer()
				}
			}
		},
		methods: {
			getAnswer() {
				this.answer = '생각중...'
				axios
				.get('https://yesno.wtf/api')
				
				.then(response => {
					this.answer = response.data.answer
				})
				.catch(error => {
					this.answer = '에러! API에 닿지 못하였습니다.' + error
				})
			}
		}
	}).mount('#watch-example')
	
	/* Computed 속성 vs Watch 속성
	- Watch 속성은 현재 활성화된 인스턴스에서 데이터 변화를 관찰하고 이에 반응하기 좋기 때문에 과도하게 사용될 가능성 있음.
	- Computed 속성 사용이 더 좋은 예를 아래에서 확인
	*/
	/* watch 사용 - 명령형이고 코드가 반복됌
	const vm = Vue.createApp({
		data() {
			return {
				firstName: 'Foo',
				lastName: 'Bar',
				fullName: 'Foo Bar'
			}
		},
		watch: {
			firstName(val) {
				this.fullName = val + ' ' + this.lastName
			},
			lastName(val) {
				this.fullName = this.firstName + ' ' + val
			}
		}
	}).mount('#demo')
	*/
	/* computed 사용 */
	const vm = Vue.createApp({
		data() {
			return {
				firstName: 'Foo',
				lastName: 'Bar'
			}
		},
		computed: {
			fullName() {
				return this.firstName + ' ' + this.lastName
			}
		}
	}).mount('#demo')
</script>

</html>